import asyncio
import datetime
import httpx
import os
from tenacity import retry, stop_after_attempt, wait_fixed, retry_if_result

headers = {
    'Content-Type': 'application/json',
    'User-Agent': 'Sample Python Application',
    'Api-Key': 'Your Api Key'
}

base_url = "https://app.welldatabase.com/api/v2"

download_path = './downloaded_files/tif'
file_pfx = 'wells_GR_'
os.makedirs(download_path, exist_ok=True)


class TaskQueue:
    def __init__(self, maxsize):
        self.maxsize = maxsize
        self.sem = asyncio.BoundedSemaphore(maxsize)
        self.tasks = set()
        self.exception_list = set()

    def __len__(self):
        return len(self.tasks)

    def _task_done(self, task):
        if task.exception():
            self.exception_list.add(task.exception())
        self.sem.release()
        self.tasks.discard(task)

    async def put(self, coroutine):
        await self.sem.acquire()
        task = asyncio.create_task(coroutine)
        self.tasks.add(task)
        task.add_done_callback(self._task_done)

    async def join(self):
        return await asyncio.gather(*self.tasks, return_exceptions=True)

    def exceptions(self):
        return self.exception_list


# Define the conditions for retrying based on exception types
def is_retryable_exception(exception):
    return isinstance(exception, (httpx.TimeoutException, httpx.ConnectError))


# Define the conditions for retrying based on HTTP status codes
def is_retryable_status_code(response):
    return response.status_code in [500, 502, 503, 504, 429]


# Decorate the function with retry conditions and parameters
@retry(
    retry=retry_if_result(is_retryable_status_code),
    stop=stop_after_attempt(3),
    wait=wait_fixed(5),
)
async def run_export(payload, headers, lower_bound, upper_bound):
    timeout = httpx.Timeout(5, read=None)
    async with httpx.AsyncClient(timeout=timeout) as client:
        print("Retrieving Files: " + format(lower_bound, ",") + " - " + format(upper_bound, ","))
        response = await client.post(f"{base_url}/files/download", headers=headers,
                                     json=payload)

        if response.status_code != httpx.codes.OK:
            response.raise_for_status()

        file_name = f"{download_path}/{file_pfx}{str(lower_bound)}_{str(upper_bound)}.zip"

        with open(file_name, "wb") as file:
            file.write(response.content)


async def download():
    well_id = ['9BFF796D-8644-4B15-9241-C4579D95768B', 'E57CD10A-C6B8-4597-ADBF-8B1435028423',
               'EC0684F2-4BA4-4014-9BC2-688AAD67A40E', 'A6CE4BE9-025B-4005-BA49-585A8C1EAA17',
               '1841C36D-EE22-4843-97A0-0ABE05BB6AC6', '64C5DFF5-740B-4B22-9D40-7F6B97F2B293',
               'BC23DFCF-4AA9-4BE3-BAC6-EEA4193F4BF4', 'FDE8CD97-AA08-4A3E-93D1-2AABEE034A30',
               '6BF4BB14-D405-422C-A87F-EBC49A5AE259', '6BE5C7BA-15FB-4C4A-8C3E-E68DB0A88148',
               '1FBC045B-809F-468A-8476-431C0FBB3860', 'D99FF34D-32E3-4F2E-959D-7C81066DAC1C',
               '80096D58-082E-48AE-A21C-4EC349F36305', '7DE14F86-E808-4706-92CA-4415A76C09CA',
               'AA0E8E54-6AFC-4DDC-B3A4-48EF55F76AA7', '24FAFF71-B76C-4053-9BF0-A131DCC21501',
               '6B61554A-FE00-4E8E-BE70-87CD36460986', '06EA808A-3D90-4087-AA4A-29ACCFF19FFE',
               '7964A0B3-964F-4744-BC17-1B9C80757DDF', '30DD8E96-2313-45E3-807B-36A33F7600B8',
               '9B77AA6B-3CEF-4BB2-A918-5180DF2A4F5D', '25384EE5-5C66-44D4-9693-F9116FA9C199',
               'C33A5827-A7B6-442D-BBBD-C9773D5CE4ED', '84317588-EE42-4D59-AE0B-0FF14EAC2BC0',
               'D038DC6F-A7C2-4385-9F44-2326AF10C06B', 'C2DCF6AE-9D80-4670-9480-2D1E528EA811',
               'E53A57B9-15CE-445B-8F55-AAEAB13E24FA', 'BF3960A6-85B3-477C-A4FC-243A02E8721E',
               '2663517E-F266-4C0E-AE2B-40855A23DA5C', '3F422DAD-7EA6-4AAA-AA79-69CADE065C1E',
               'EE4AB947-04E4-43D1-8CD0-FCCF2FDEC5CE', '3D15CE97-2874-4E73-A549-B2CAE068EE8D',
               '228A7FA2-37AC-442E-A87E-22D8C349B393', 'A27DA3CC-C718-4DD0-A29A-28CE097B3B99',
               'AA44C903-9445-43FE-986D-0382057A0745', '0C42E99E-2CF5-4C83-979F-0858B3F21007',
               '3AB516D3-EAA0-40D2-91A6-706EA926C57D', '6DE554AE-4D7F-4E76-924D-32032ACB8FF9',
               'BC20E224-31E0-4786-B35B-C90053545C39', '7B349E8A-B4D1-434B-AE1A-9A428CB59EA2',
               '1E8920AA-908C-4442-BFF1-503EFDB804B7', '156872D7-F172-4B75-87B1-AC629F08918C',
               'E8513860-699E-40E2-86E9-1AD5A88A9A4F', '3E6FEAFB-03AD-45C0-B7C4-1575FAAD8DC5',
               '5DCCA408-C54B-4E34-9959-4EE037A47EC0', '2BBB27B1-4BAF-46A0-A003-C5559CB806FD',
               '714D92EA-8270-42AD-89AF-E3DA19C685F9', '3252F9A5-9446-479B-BD40-8BCDC090C9B7',
               'D17AD567-F137-474B-B24A-A0D11BA06DAB', '7987C72C-4CE1-4F59-840B-C2CEA6B30435',
               'BEAF3E39-8503-4A60-9E8C-D23B5C39A4E2', 'BC90E46D-982B-4F91-8449-30C501F9FCD5',
               'B1DA0C19-6226-474A-881D-29834F13E445', '39C1C6D4-F963-494F-89AC-14B9BBE9880B',
               '7D662C96-726D-4C3D-A718-CFC015382DA0', 'DBC173F9-B1CA-4660-89D4-66A4732FA01A',
               '316D966D-58F7-49CD-A6E5-F3BE4FC9D0F8', 'CAACE96B-4F43-412F-BCCF-9A796EA7EDE5',
               '20C30D1E-18E7-46F7-8DBB-BDBAE9B3A250', '9CEFAF6B-CDB4-4DC8-B6DB-2BF7FC7D2F98',
               '508DE825-083A-42AC-B578-4FEA52813151', 'F5B72F75-638F-4A2D-AC3D-9C51BA8D0895',
               '1066AA3C-4867-449F-B9A3-23C64C2B4933', '1BF0F119-CF30-40DF-A176-05A3674DC200',
               '541C9EBA-B41B-4B28-AE41-B4D0B103C2F6', 'FCB5A368-0EB2-4656-B4D8-BCE8C2C3D4BA',
               'C8C3E30C-0A92-4203-9CC8-716C64B89C4B', 'B16BC0E7-25E2-4B15-B829-0E0F77BF6B29',
               '4C77FABA-E1FD-4686-AED2-42CC0D6084A9', '1B107321-68E1-43F2-89A9-41C07EB797AC',
               '3648D0BF-8DB3-4C64-823A-D0E5F2D7207E', 'B06936F6-D474-422E-87A4-698D9C7F9C01',
               '357B3822-6347-4EA9-8D63-9C8966C9BE2B', 'CA41BB7B-2D72-4D25-B103-F9FFEF762904',
               'A0F7BF86-52BA-44DA-9CE4-48CC4BAC7A2D', 'EF0A57B7-B723-45FB-96A2-C87277DB4C4C',
               '9F1CE9B3-D457-4D5E-BC4E-9BE3F6888E1E', 'E8A2CE2C-333E-40D5-A322-46F3D219FB08',
               '7560F7CE-C1A1-40DA-BDD5-98EA01588432', '59B1CFB5-E198-4594-9E6C-59C43FCBC116',
               '0D86BBE3-18A9-4660-883E-6D2ED622A232', 'BC3D9956-6F9A-43E0-84D6-E6E88C3C5D5F',
               '50F418D9-08BD-47CC-8905-0D47E4FCC143', '6A733A3F-B0C1-42AE-A125-0623BABBA6E5',
               'CA4A8BC1-9268-4C4C-9C75-C7B6B1351DBE', '82DC8F1A-0608-444A-B5DA-A07A95F7C1F7',
               '75EE1073-71A0-4DA5-89AF-05792DBAFDEB', 'D7735C17-6EB6-4ED7-81AE-10E5D62BFC1B',
               '8F17E498-8D9B-4873-B152-9EDF930B0F27', '92CF8352-C65D-4BC0-8646-91E1278062D6',
               'ECE4BD5E-4FB6-49FD-A398-88CB0856406C', '10A76DDD-DE0A-4850-B543-962429C0D172',
               '2E02B5FD-2989-46E0-AAD6-D25FA2A31A69', '5C26ED5E-F6A9-46B4-B43A-C12D5FA9239C',
               'AA2F172D-AAAF-4BEC-9D3E-927AB5966430', 'DCE8B97F-63FE-4B18-8E7D-322A70D98D14',
               '4811FF2B-911C-4BEA-84E6-5422489E4A15', '2E48D4F7-1A77-4C3C-AD89-D623F887C0FD',
               '21E049FA-077C-4EF0-A9AA-9187CEF1D21E', '12CA6D56-E1FD-4854-BB3B-569340B0E688',
               '71B90A5B-F88E-4959-9FC3-6BDE1A5A25C0', 'CEC3765D-D1FC-4EF8-A4C8-4AADC986FDBC',
               'B3C081C4-034E-423D-8FC9-9B235A86A465', 'F1B67F41-080D-40B9-A4EA-541CCD65E1CF',
               '2D23BDA5-0165-4FB4-A777-3BF01D0671EA', 'EFCC29C6-DBC9-43E3-BDEF-6B222886D398',
               '081D8DCD-68D6-44DB-A1E7-53DCC7B010AA', '217E21E7-226C-4CDB-86FC-CFEF573C576F',
               '85B3C8CC-EEF1-4855-BCC7-538078A48D22', 'CFCFC141-4228-4831-941F-A801E18835F0',
               'E872587F-E21E-425A-982C-672C806CC408', '33A085F7-51E3-4710-85DD-270846234AD4',
               '3CB10ED6-34C4-4894-BE68-C281A5925E4D', '9B610789-51DD-4A7A-B9D5-B7512CAF9A83',
               '46939A03-46E5-4498-84FE-F9A892F89BD3', 'DD3045C1-294B-4C19-B21B-501A6176BBA8',
               '850D3600-4686-4742-8CE4-BEEF915340CA', '7F3B1C05-0AE4-4EF4-92D0-4BB481B14AE9',
               '3D259D48-34BF-4EC8-A072-240C6883F95A', '7C64EE19-BDD2-4E49-9B39-3358FB4A79FB',
               'E5515BF3-D037-49EB-87EA-D5067BB1284C', '7948C9D6-CF7B-42A7-910F-EF0877DC2DBE',
               '6C96A5EC-193E-4219-8E89-E2521AE1641F', '0A78543C-010E-43E4-B7A7-19D82BB21894',
               'C38DDE08-AA6E-4731-ADF5-0D4D0485AC25', 'A7A1E41A-2F27-4A63-B161-8E05E6B32E8F',
               'C77F285D-AA83-41FC-874B-71D1652D557D', '29E46426-1EF8-4DF8-B79D-A750E5685DF7',
               'D363C5D9-8A2C-42CE-BD1A-77130D63D889', '99431F51-24C3-409F-9042-0036A0A14395',
               '7FE6DE10-20ED-4649-B315-5ECACCE4A971', 'A60970F9-0BA2-4794-86D3-2DD40182DA4C',
               'D227BD86-17DE-4324-8C73-489129D994B1', '0E1F0A78-8D9E-4B58-8307-348A11180D6F',
               '077758BA-1ECC-4DBE-BFF3-48C772CCB067', '74B28DD9-BFDB-4C8D-80F8-A86C9869EA4F',
               '8E39C6B9-CB0C-4453-A2CE-FA01B4802491', '53B05F0E-0D5D-4327-B25E-3FABCEB9D063',
               'C8763E8A-C99B-467C-A67D-4A08365D7624', '8203796B-1A83-49DC-8829-E27CB3A62952',
               '6EAD7E3C-721D-4C3C-A1D5-2CDD3024F410', '7E4087C6-9949-41FC-B0A0-2801FD76FB63',
               'A8566807-83AC-4E89-9C3D-A64436B4589F', '8F4853D7-C314-4814-86BB-CC5FE632A0E8',
               'EA215F22-228F-45DE-97C9-2B1388BE4B8C', '1450F135-50BD-4BD9-A35D-A771EF540DC2',
               'FC1A7AA6-31CA-4F89-B849-05388C72DA07', '13F32EE1-6C82-4B98-8482-1B5EF3CDB4B9',
               '35FE3AC0-8BDB-44FE-83AF-007772AE49B9', 'B85976A5-BB98-4687-A0EA-532882657ECE',
               'FDDAF767-FDFF-448A-8800-B53C6B19482F', 'BE446107-89A4-40AB-B425-340BB1939DA8',
               '1545AD44-AD47-47E2-883E-5BDF7AD5FF33', '1543C06C-E8FD-4A3A-9D5E-B700ACC842CD',
               '4FB5DECD-B9F4-422F-A8E5-3AE9CDAC8471', 'EB573433-C61A-410E-80A4-27A143849C7A',
               'D66E4C52-F8C7-4932-BBA0-23BB0268BC78', '3790781F-FDED-405D-BC0C-B52DB3012461',
               '0E339566-D13B-462C-BF39-E7BF214E21E8', 'D0152345-02BE-4916-B38F-B0D0809CFEAD',
               'A8AB0B43-EA1E-4097-A15B-0AEC3F94AF21', '9ECB0A45-F33D-4587-935E-B48B2DB0C7E2',
               'CFAD9FAE-9CB3-4559-91C1-329F5437709E', '4A14C912-EA14-4C8E-9AE5-3BFDA85EA13C',
               'DD9FFA9A-7CE9-45D7-9615-48C5AB346C0B', '6119F58F-8491-45E2-A5BF-4595083BDCFF',
               'F4768A89-9F20-4261-A5D0-7787D6553567', '892E2F6C-DC9B-401B-ACBC-7F9589145AA5',
               '0E13BB7D-1723-4880-8A9B-AF8C214EC3CC', '585546DF-4213-4D32-B6CF-41EDA44C3019',
               '6B98CEE4-2626-4FE1-9DE9-E881E3243FA7', 'ADDFF29A-17F7-47D2-866E-5B2E4367DD5C',
               'DE34DAAC-A5C8-420C-8E8E-F8B9874EA70E', '329BCBAA-16EE-40D3-9D70-861DA87BBD8A',
               '09E59121-0CB2-4A43-8559-5C43F6117779', '72FC79AB-2DCF-4548-92A7-5E102B14A427',
               'E7CC7370-68F9-4C52-8EDD-6A908395D272', '67A24F9E-D742-40F5-B9D3-218A3F9AD4F0',
               '6913A988-9B83-416B-9423-E750C2D7AD73', 'BBDE8578-CA29-46E7-A102-9C3BB37B7F4A',
               '89CE38C3-491C-4E0C-BF20-CF9E303B1DA6', '20503228-9771-49E7-BD53-095074AE2E4E',
               '2794FE8B-E6C7-4C69-9FA8-B04C4AAEDE95', '9B9EAE7F-32AF-4D90-B480-6560588EBB49',
               '123DC7D0-0F49-4A20-8A24-BDA2D91C17F3', 'D4D20C68-6FC4-4725-B291-8B58F5FA8215',
               '5E392D0D-DCA5-46F7-A23C-AB0C4BF339EA', '4B53F47C-9E14-495F-A209-DE938A7C0687',
               '56F162A5-1933-467F-B46D-6DCCD304E664', '7E15A22D-C240-4306-AD6D-CD2D9D0966A6',
               'A285064B-3F20-4699-AA19-73309F0E89AC', 'CE184F4F-C51B-4186-AF1F-B38AD90ACFA5',
               '6430245D-D00F-4521-8BD1-78E70B3D6CF6', 'A2E6511F-496A-411D-BE16-FA28DE627860',
               '917ACB96-C193-4345-BC6A-D723BED06808', '2F933756-1B3C-4C0E-A24B-24D97E5F70F2',
               '49468174-AD78-491F-9F30-BC72DC2FC00F', '5D9BB803-C958-4CCC-A063-B3AECF958497',
               '040A69D9-06A1-4463-88F3-4B44999BAC8B', '5319675D-1B64-4E64-A5F1-55147CEA9903',
               '472C4220-0F72-403B-BE46-DEE5CCE09AA5', '7AEDC82E-9800-47B7-BEA6-97456D9B0464',
               '35CD506C-0660-4C80-8F99-FD90A3CBB532', 'E14398B8-F2B1-4200-8FF9-DAAA7D503B4B',
               'C5E8F1D6-5C86-4CBB-A7E6-C6A6DAE67423', 'FC70951E-79CA-4837-BB3D-D06CF17FBAE1',
               'A65B7C88-6BE1-4D59-999A-BED7262843D6', 'B2BD2B43-2E18-4E81-9DF9-1EC45AB35EEC',
               'D917B535-F98F-4740-8074-A96C9FEBE360', '281899D9-93DF-4A9F-ADFE-22AB647FC618',
               'F9FBAA3D-9C8B-4A6E-AC56-19DA348D2DFE', 'E465E486-F9BA-42BA-AA6A-8F28A4F15164',
               '40DDD2A4-B561-4E40-B228-A9E185D571D4', '0345FFF3-94B3-437A-9455-CEE0A55FA78B',
               'A6304795-B713-4B28-ACEA-9E2D9DA08B0D', '990816AF-84A7-4F6D-9AE8-4B937FC99141',
               '72DAF6DD-9A39-47A9-AA56-263C9580694A', 'E98C88C9-6D18-4E5C-BDD1-1A2BE5616FFA',
               'F2FB1CEF-4823-4F41-9E44-186653F4E4A4', '29E8782A-F3A6-4BD1-BE6B-2DE7F43F9194',
               '2162405C-549E-465F-8EF3-F8617F1CE12A', 'F04C6970-359E-490A-874B-89EE8400C423',
               '2AC64EF2-93F0-48C5-A0EB-B638901B2A2A', 'CE6C4929-C674-4DF6-A7C1-9817B0C1967B',
               '1160FE7A-5474-4840-853F-D140FB00CFEF', '50FF09F8-4FB7-4F3F-88C5-A1FF9EDCE98F',
               'CCB4B3AB-2892-4869-824D-643C73FA3F72', '2FD648F2-74DA-4C28-83F5-060517A6684C',
               '5A62E3E0-7D8E-4BB2-9738-A0575AF8903D', '09B693F3-3485-420F-BE24-E90A99A2F26C',
               'B6C00FC0-5C31-4B7C-9B83-2DB7F3589CA4', '30831815-6879-405D-AE4E-29744C391A64',
               '39021BDB-2ED7-4CCE-A223-F85CEB4D9CB8', '0F895B73-B69D-4552-A0DD-06CBF10990FD',
               '2231A9CE-357E-45F7-8525-670E82169F9C', '413B5800-90B0-46E8-AB7D-D8F23C07CBE7',
               'A13C0A57-D093-4AB2-97DB-4A3E4BB4A5F1', 'AC89F040-A397-4BFD-9AD4-BB487FFC7029',
               '7CD3A0FF-A2C4-43B1-B31B-F7D0D68A8442', 'F6AE7AEE-2F4F-4A6D-BD78-4C307281FAD5',
               'E1D52E91-1BDD-4CBF-9CDE-BD8F81FC309A', '99CC705D-7CB4-4715-A15F-4F7589071ADE',
               '8247B3F5-1291-4B23-A704-4FFEAB038FDD', 'B085861E-FBC6-4F87-A0E9-0931340C4B31',
               '4C59CD23-D76B-4C2D-B1B9-2DE4FBF876E1', 'B84A42E2-5884-40E9-A794-3C22AB40ED5A',
               '6DA8D41A-D6D6-4A55-96CD-AA677FD72472', 'C3BC5561-DD8C-40FF-81C3-49F83FB7EF5D',
               '53A9DAA4-9553-43FE-B0EF-36E131288621', '9D5388F2-6C94-4167-B711-B1BF9460018E',
               'AC5C42D9-DEB5-4894-AA23-0798CC6A8218', '23AAB840-74D6-4EFC-8091-0A9E482CE5AA',
               'EE2A95D6-6A4D-4BD5-969E-1DA588761856', '56C7C69A-D47C-4B0D-8756-FD9A6A81DF45',
               'EFB59FA1-B966-4775-B390-3D7C297C1D1C', '1BF6BFAE-9A08-46F7-A3ED-C7DBB1790B37',
               'E11B16DE-46EC-41DD-9520-EEE1BC4818B4', '8F75CAA5-E82D-4567-8765-BD0D115744F5',
               '2C01BC3A-D17E-4DE3-8E09-A21F98C36CA8', '97A7118E-A132-426C-8F17-D0E423AFF684',
               '4BC1D029-D750-4A91-AD47-2E417A6E4CE8', '0163890A-36A3-4AA5-A12F-89799549D952',
               '5824FB27-C088-4246-8CDA-4AC4A1081874', '520D51DD-3CA8-428D-81B7-21B597167287',
               'DD28431E-6674-4FE2-AB71-07539FEFAD49', '90B8B84D-B793-4AE2-BDF3-3B8183E6C666',
               '6DA2E6B5-A58F-4482-AE0E-4D1C3270E78C', 'CA3E92DA-B2D6-48DF-A2F0-83F307C4EC29',
               'F3BE7F3E-2424-4E2E-B38B-E1427BCA4F13', 'F32E67EB-F26C-462B-B429-420732E2CAF9',
               'B0DA9C11-237D-4EFD-99BE-1BF5FF545813', '509A3AAF-733A-47C2-8C99-65C1B2EF9E4B',
               '5019F862-3EBF-4AD0-B497-52E8C6AFB3C1', '9D81DB5A-0EAD-4955-81FE-0EEB8F050DCF',
               'DD468BEB-5148-4D10-9B29-4401D471EFBC', 'CEB4EE07-AA66-4C3D-914F-24E6BF0EEFD1',
               '10E3B846-4C96-45CB-BD92-6B0AB23F92B4', '36EAE82D-DC7E-4826-B97F-26D507621AA9',
               '8D66E597-5C8D-44AF-ADFA-3541F5A5FD2D', '2FAC2BC1-A9C7-4C02-B0BD-05CAF0536D82',
               'E733D17A-ADA8-4F51-BC05-EF31621D986E', '59B67A60-2C76-4D6A-B8BB-6D5F0B67EDD8',
               '6D5E4061-1C53-4CDE-BEBA-768F8B1AD320', '4C2A2048-E8B5-41EC-82DC-B6FC65D1F86B',
               '7ED4532E-BE67-4677-BBF6-F56C7EC43B93', '68F9BE11-F403-473C-8B32-2D9684A9E672',
               '14619B94-485A-4A09-A5B6-E9D0773B2068', 'D124F545-6883-41BA-BF87-9E69509E4D9E',
               'D6E8EE00-BB49-49BC-992C-C2F4477AE9DA', '7A042D96-E1E2-4961-AAA8-EB3375A648BD',
               '59EC8C93-DD8A-45FF-8700-CAD08E8E77D7', '9993627D-7E22-4EA6-9859-2604A4BFDDC1',
               'DE8342D8-AFBB-4AE6-ACF3-9420FE9E91D9', 'E26662D8-88AB-41AD-BEA4-FB47C7D17650',
               '0BC5D792-CF01-45C2-8F34-4A6052F27B51', '9E870CF7-9978-4259-849F-BC01732B178C',
               'B6BA177E-91FF-462C-AF2A-316C172BD1FA', '4F92D7A4-91B0-405C-8A0C-9F53E2C9686A',
               'E7DA928E-F272-40D1-9316-2672A8199E16', '2C31DCAA-F28C-444C-9BEF-6B8AFDF2A122',
               '5646B992-8FCD-475C-9F24-869F1A91572A', '54352598-A46B-4C34-90A6-41F2D3F6132B',
               '32E10C21-A6D0-46B5-9C05-EDA85767C412', 'F429D634-348E-45BF-A01D-A9C7DCEEFDFB',
               '88FE41D4-7CE2-4523-9BC0-09426162912D', '93C8C43E-ADB7-48EF-AB4A-0AACE3725BA2',
               '986F32FF-8A78-4391-A5CB-2A4039839E08', 'DCFC6F6F-1FC2-40E1-8134-E622B5050B7A',
               'B7A350E5-1DF3-4D59-965A-0E66A890917E', 'B8C29C8E-59CE-47DF-85E9-B2A6F55CA6C1',
               '80626EB7-65D9-468E-B714-61B0BAA80E6B', '1F7953B3-72F7-46F4-84D3-026C52F9E9B8',
               '4E22C8BA-316E-4F14-ACCE-A502C119C1AA', '1EC6D250-9176-484B-8778-767D5D654A83',
               'F5EBBE08-4FE9-4265-8136-6443EFB7AD4D', '2D5B8906-772F-4976-9BD8-CFF7FFE6D4FC',
               '7E057C76-15F8-40B4-8E75-CC4772A03689', 'EF35888D-8524-425C-AD59-4DBB87911B2F',
               'E714EF08-58A2-48D0-8808-3AC6B60AD567', '9B0AF0F5-8433-4461-A009-70775BD0CA09',
               '4906D745-447C-41C0-ACB9-DB40F996D8CA', 'ABAD3B73-AF12-48FB-B20E-A69A6DCDCDAD',
               'A838914E-182E-40B6-8E51-42803BD51211', '33EFF7D9-0067-44DE-9DB6-8ABF31CEAE3A',
               'F75725A8-5C0C-40D8-9A59-1603C5E7546A', 'F498E066-D0E5-4AF4-92E5-06D2DB06FA30',
               'A57D9B7B-5707-42D8-BA09-7F41618E4C74', 'BD93E104-DEE1-4B0B-A4B9-E391DFD5F357',
               '4D93FC0E-D1C1-4412-B9A0-88555D6502F8', '036AC2D6-C0FA-4191-B01D-54E377FFFE58',
               '07C1AEBB-6835-4581-8E69-A273666BAD8D', '838B42E6-3281-40E5-B6A9-EF318CF77DBA',
               '09ED1F33-548D-4614-BB89-053A02DC94C5', '6B202DF1-C7B7-4A21-9AFD-D0DDBBE189F5',
               '0442F33D-D5E8-4E37-8585-068DC84427B3', '0AA0E293-C953-41D4-857B-4BACDE99F31A',
               '37C899E0-6068-4D31-8720-2B83A8D7379C', 'D0AF1061-D869-41CC-9356-73EA75A71F49',
               '274232C6-C7CD-4258-91B6-6085239034FE', '7D71CEF1-6D98-4F59-AA2B-FBD7F1A87FB4',
               'ACF2CFF8-C683-4D7D-AA23-112EADCF6216', 'D43821DD-1EE4-4A9B-B45B-8C4D9DE2FA10',
               '6517670D-F3B0-41C4-8B93-3282523AD064', '354D3CFF-8140-45FB-A2D7-B085E92D709B',
               '1D9F0B23-2275-4CB6-A276-B57BB81E86E3', '08A0314F-6F88-41CC-8D06-BBB856B23AD7',
               'FB2C7DAE-5BD6-4815-9AB5-E691FB519804', 'A8C27288-6C2D-446B-9AEF-CD5643FEE9E8',
               'F38B52C8-3121-4822-95A7-BA36BCAD5CA3', 'C1076E60-2EE5-4C87-8817-0D860F1CCCBF',
               '71027E7C-571C-4CB6-ACAD-8BBFA055D89D', '6F1AF10C-1894-4798-AFF5-EE149C1F41DB',
               '1DEA5A96-13D9-42B4-A53E-B99949F6F7FD', '11476407-B02B-40E6-8E88-962BBFEB0ED6',
               '084AC6C8-A0E7-4F2C-9CEA-3061E7E23993', '1E6C2BEF-4E0A-425B-AB3B-8E6F7FA7788F',
               '565B77D1-1274-4BB3-B5C6-5D5AC9FC453B', '8F55CF55-CC45-4BA9-BCF2-3611EB35FB64',
               '11E3C571-49A8-4C3A-8410-F8F9E18673F7', 'D49CF14D-81FB-4C2F-A28D-AEAEC5DB3AED',
               '7B88D843-F66E-4C95-AA82-25C9796BACED', 'D6598B0F-C1C7-4505-9D8A-4CEA88283502',
               'A1A87C94-73AB-422E-8C6D-21565C23BBD2', 'A9848193-D1ED-4BA8-BAB9-9B0592CDB3B0',
               'CC8D0FCD-680E-4221-906C-75F39471C37A', '1E1D63A4-0BEF-4294-9392-B99807F9E470',
               'CB8DA11F-E833-4467-9A53-C4AEB71B9A08', '540045D0-CB55-46CC-960F-4A28B50C85F8',
               '22F9E500-0D5B-445C-AE7B-E6C70182EF5D', 'F4CE69BE-7E01-4269-B89F-1E8D1FC07872',
               '4C56AFC6-4827-49DB-A63C-26A25CDAE5F0', '77D6E590-91F8-4FFB-B379-E73D0CB01D50',
               '7BCE7C1A-9AD3-4E34-8C76-658AD6B5D2A3', '742FEE01-608E-4721-AD1B-0DB4186FE61F',
               '6DAC1F03-9C6C-4B3D-8347-5A4CF47444B3', '551F399E-9FC6-4D47-9F87-430725058A36',
               'A1D26BC5-CBE8-473E-81AE-EF65E3AED00E', '5833D115-EFD2-41E7-875A-2A53B62C24AC',
               '70F2D246-9F4C-4356-A475-EF39A24A26E4', '62252F6B-5570-4959-BEEA-33FE392B2D07',
               '29AEF8A2-1492-4715-AA01-18D3843279FD', 'DFA3395A-5FC0-4629-8A4C-7C4A9473FE04',
               'BF37A3D7-4B02-40BC-B395-4448F346451B', '43B4889B-E92B-4DBB-82BB-C15FCD6F462D',
               'BF441A6D-0ED7-411C-96D1-10FD9BDB7A7C', 'A5BC8B36-6FE7-49DE-A753-797667F423C5',
               'C646D6E0-6173-42CF-84D3-0B975D3330C5', 'F81D3B9C-6425-4B05-AE2A-F2FE3949BB00',
               '0B3E6A1D-EC0C-4B65-A076-2394F84670B6', 'FAD369D0-8696-4B1D-AC4C-7785EABD4FDF']

    #4 concurrent exports
    tasks = TaskQueue(4)

    page_size = 100
    total_files = len(well_id)
    current_offset = 0

    for i in range(0, total_files, page_size):
        upper_bound = current_offset + page_size
        batch_ids = well_id[current_offset:upper_bound]
        searchPayload = {
            'Filters': {'Ids': batch_ids}
        }

        downloadTask = run_export(searchPayload, headers, current_offset, upper_bound)
        await tasks.put(downloadTask)
        current_offset += page_size

    await tasks.join()

    for err in tasks.exceptions():
        raise err


print("Starting Download - " + datetime.datetime.now().strftime("%m/%d/%Y, %H:%M:%S"))
asyncio.run(download())
print("Done - " + datetime.datetime.now().strftime("%m/%d/%Y, %H:%M:%S"))
